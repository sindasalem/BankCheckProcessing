{"version":3,"sources":["webpack:///./node_modules/cordova-plugin-scanbot-sdk/camera.js","webpack:///./src/app/html5-camera/html5-camera.module.ts","webpack:///./src/app/html5-camera/html5-camera.page.html","webpack:///./src/app/html5-camera/html5-camera.page.scss","webpack:///./src/app/html5-camera/html5-camera.page.ts"],"names":[],"mappings":";;;;;;;;;;AAAa;AACb;AACA,2BAA2B,+DAA+D,gBAAgB,EAAE,EAAE;AAC9G;AACA,mCAAmC,MAAM,6BAA6B,EAAE,YAAY,WAAW,EAAE;AACjG,kCAAkC,MAAM,iCAAiC,EAAE,YAAY,WAAW,EAAE;AACpG,+BAA+B,qFAAqF;AACpH;AACA,KAAK;AACL;AACA;AACA,aAAa,6BAA6B,0BAA0B,aAAa,EAAE,qBAAqB;AACxG,gBAAgB,qDAAqD,oEAAoE,aAAa,EAAE;AACxJ,sBAAsB,sBAAsB,qBAAqB,GAAG;AACpE;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC,kCAAkC,SAAS;AAC3C,kCAAkC,WAAW,UAAU;AACvD,yCAAyC,cAAc;AACvD;AACA,6GAA6G,OAAO,UAAU;AAC9H,gFAAgF,iBAAiB,OAAO;AACxG,wDAAwD,gBAAgB,QAAQ,OAAO;AACvF,8CAA8C,gBAAgB,gBAAgB,OAAO;AACrF;AACA,iCAAiC;AACjC;AACA;AACA,SAAS,YAAY,aAAa,OAAO,EAAE,UAAU,WAAW;AAChE,mCAAmC,SAAS;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,SAAS,4BAA4B;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;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","file":"html5-camera-html5-camera-module.js","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nexports.__esModule = true;\nvar ScanbotHTMLCamera = /** @class */ (function () {\n    function ScanbotHTMLCamera() {\n        this.video = null;\n        this.canvasContext = null;\n        this.isDetecting = false;\n    }\n    ScanbotHTMLCamera.prototype.getVideoElement = function () {\n        return this.video;\n    };\n    ScanbotHTMLCamera.prototype.getCanvasContext = function () {\n        return this.canvasContext;\n    };\n    // @ts-ignore\n    ScanbotHTMLCamera.prototype.initialize = function (container) {\n        return __awaiter(this, void 0, void 0, function () {\n            var constraints, stream, canvas;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.container = container;\n                        this.video = document.createElement(\"video\");\n                        this.video.defaultMuted = true;\n                        this.video.autoplay = true;\n                        this.video.setAttribute(\"playsInline\", \"\");\n                        this.video.setAttribute(\"webkit-playsinline\", \"\");\n                        this.video.style.width = \"100%\";\n                        this.video.style.height = \"100%\";\n                        this.video.style.objectFit = \"cover\";\n                        container.appendChild(this.video);\n                        constraints = { video: { facingMode: \"environment\" } };\n                        if (!this.isiOS()) return [3 /*break*/, 2];\n                        return [4 /*yield*/, cordova.plugins.iosrtc.getUserMedia(constraints)];\n                    case 1:\n                        // @ts-ignore\n                        stream = _a.sent();\n                        return [3 /*break*/, 4];\n                    case 2: return [4 /*yield*/, navigator.mediaDevices.getUserMedia(constraints)];\n                    case 3:\n                        stream = _a.sent();\n                        _a.label = 4;\n                    case 4: \n                    // @ts-ignore\n                    return [4 /*yield*/, new Promise(function (resolve) {\n                            _this.video.onloadedmetadata = resolve;\n                            _this.video.srcObject = stream;\n                            _this.video.width = container.offsetWidth;\n                            _this.video.height = container.offsetHeight;\n                        })];\n                    case 5:\n                        // @ts-ignore\n                        _a.sent();\n                        canvas = document.createElement(\"canvas\");\n                        canvas.width = this.video.videoWidth;\n                        canvas.height = this.video.videoHeight;\n                        canvas.style.display = \"none\";\n                        this.video.parentElement.appendChild(canvas);\n                        this.canvasContext = canvas.getContext(\"2d\");\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Public functions\n     */\n    ScanbotHTMLCamera.prototype.startBarcodeDetector = function (formats, callback) {\n        var _this = this;\n        this.formats = formats;\n        requestAnimationFrame(function (animCB) {\n            _this.isDetecting = true;\n            _this.sendImageData(callback).then(function (r) {\n                // Nothing to resolve, carry on\n            });\n        });\n    };\n    ScanbotHTMLCamera.prototype.stopBarcodeDetector = function () {\n        this.isDetecting = false;\n    };\n    /**\n     * Static object creator\n     */\n    // @ts-ignore\n    ScanbotHTMLCamera.create = function (container) {\n        return __awaiter(this, void 0, void 0, function () {\n            var camera;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        camera = new ScanbotHTMLCamera();\n                        return [4 /*yield*/, camera.initialize(container)];\n                    case 1:\n                        _a.sent();\n                        return [2 /*return*/, camera];\n                }\n            });\n        });\n    };\n    /**\n     * Internal private functions\n     */\n    ScanbotHTMLCamera.prototype.createImageData = function (canvasContext, imageOrVideoElement) {\n        canvasContext.drawImage(imageOrVideoElement, 0, 0, this.video.videoWidth, this.video.videoHeight);\n        var width = this.container.offsetWidth * 1.5;\n        var height = this.container.offsetHeight * 1.5;\n        var x = this.video.videoWidth / 2 - width / 2;\n        var y = this.video.videoHeight / 2 - height / 2;\n        return canvasContext.getImageData(x, y, width, height);\n    };\n    // @ts-ignore\n    ScanbotHTMLCamera.prototype.sendImageData = function (result) {\n        return __awaiter(this, void 0, void 0, function () {\n            var data, imageData, octet;\n            var _this = this;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        if (!this.isDetecting) {\n                            return [2 /*return*/];\n                        }\n                        data = this.createImageData(this.canvasContext, this.video);\n                        if (!this.isiOS()) return [3 /*break*/, 1];\n                        imageData = data.data.buffer;\n                        return [3 /*break*/, 3];\n                    case 1: return [4 /*yield*/, this.Uint8ToStringViaReader(new Uint8Array(data.data))];\n                    case 2:\n                        octet = _a.sent();\n                        imageData = octet;\n                        _a.label = 3;\n                    case 3:\n                        // Uncomment for web debugging\n                        // requestAnimationFrame(() => this.sendImageData(result));\n                        // TODON'T: Do not follow the suggested Add 'import {cordova} from \"@ionic-native/core\"'\n                        // The ionic core import is not correct, we want to use the \"cordova native\" function\n                        // @ts-ignore\n                        cordova.exec(function (success) { return __awaiter(_this, void 0, void 0, function () {\n                            var _this = this;\n                            return __generator(this, function (_a) {\n                                requestAnimationFrame(function () { return _this.sendImageData(result); });\n                                result(success);\n                                return [2 /*return*/];\n                            });\n                        }); }, function (err) {\n                            requestAnimationFrame(function () { return _this.sendImageData(result); });\n                        }, \"ScanbotSdk\", \"detectBarcodesFromBytes\", [data.width, data.height, imageData, this.formats]);\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ScanbotHTMLCamera.prototype.Uint8ToStringViaReader = function (u8a) {\n        // @ts-ignore\n        return new Promise(function (resolve) {\n            var r = new FileReader();\n            r.onload = function (ev) { resolve(r.result); };\n            r.readAsBinaryString(new Blob([u8a], { type: \"binary/octet-stream\" }));\n        });\n    };\n    ScanbotHTMLCamera.prototype.isiOS = function () {\n        // @ts-ignore\n        return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n    };\n    return ScanbotHTMLCamera;\n}());\n\nmodule.exports = ScanbotHTMLCamera;\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { Html5CameraPage } from './html5-camera.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Html5CameraPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [Html5CameraPage]\n})\nexport class Html5CameraPageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button defaultHref=\\\"home\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>html5-camera</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding>\\n\\n  <div id=\\\"container\\\"></div>\\n\\n  <div id=\\\"foundBarcodeHeader\\\">Found the following barcode:</div>\\n  <div id=\\\"barcodeFormat\\\">{{barcodeFormat}}</div>\\n  <div id=\\\"barcodeText\\\">{{barcodeText}}</div>\\n\\n</ion-content>\\n\"","module.exports = \"#container {\\n  width: 96%;\\n  height: 200px;\\n  margin-left: 2%;\\n  margin-top: 10%;\\n  background-color: #10dc60; }\\n\\n#foundBarcodeHeader {\\n  margin-top: 20px;\\n  font-weight: bold; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvaHRtbDUtY2FtZXJhL0M6XFxVc2Vyc1xcVXNlclxcRGVza3RvcFxcYmFua2NoZXF1ZS1mcm9udC9zcmNcXGFwcFxcaHRtbDUtY2FtZXJhXFxodG1sNS1jYW1lcmEucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0VBQ0UsVUFBVTtFQUNWLGFBQWE7RUFDYixlQUFlO0VBQ2YsZUFBZTtFQUNmLHlCQUF5QixFQUFBOztBQUczQjtFQUNFLGdCQUFnQjtFQUNoQixpQkFBaUIsRUFBQSIsImZpbGUiOiJzcmMvYXBwL2h0bWw1LWNhbWVyYS9odG1sNS1jYW1lcmEucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiXG4jY29udGFpbmVyIHtcbiAgd2lkdGg6IDk2JTtcbiAgaGVpZ2h0OiAyMDBweDtcbiAgbWFyZ2luLWxlZnQ6IDIlO1xuICBtYXJnaW4tdG9wOiAxMCU7XG4gIGJhY2tncm91bmQtY29sb3I6ICMxMGRjNjA7XG59XG5cbiNmb3VuZEJhcmNvZGVIZWFkZXIge1xuICBtYXJnaW4tdG9wOiAyMHB4O1xuICBmb250LXdlaWdodDogYm9sZDtcbn1cbiJdfQ== */\"","import {Component, NgZone, OnInit} from '@angular/core';\nimport {ScanbotHTMLCamera} from 'cordova-plugin-scanbot-sdk/camera';\nimport {ScanbotSdkDemoService} from '../services/scanbot-sdk-demo.service';\nimport {DialogsService} from '../services/dialogs.service';\n\n@Component({\n  selector: 'app-html5-camera',\n  templateUrl: './html5-camera.page.html',\n  styleUrls: ['./html5-camera.page.scss'],\n})\nexport class Html5CameraPage implements OnInit {\n\n  public barcodeFormat: string;\n  public barcodeText: string;\n\n  constructor(private sdk: ScanbotSdkDemoService, private alert: DialogsService, private _ngZone: NgZone) {\n      this.showDetectionResult();\n  }\n\n  async ngOnInit() {\n    // 'requestCameraPermission' is a helper function, not required by ScanbotHTMLCamera.\n    // If already have your own logic (e.g. another plugin) to request permission, feel free to do that\n    const permissionResult = await this.sdk.SDK.requestCameraPermission();\n    if (permissionResult.status !== 'OK') {\n      await this._ngZone.run(async () => {\n        await this.alert.showAlert('Camera permission is required to capture video stream', 'Oops!');\n      });\n      return;\n    }\n\n    const container = document.getElementById('container');\n    const camera = await ScanbotHTMLCamera.create(container);\n\n    camera.startBarcodeDetector(async result => {\n      const info = await this.sdk.SDK.getLicenseInfo();\n      if (!info.info.isLicenseValid) {\n        camera.stopBarcodeDetector();\n        this.showDetectionResult('License expired', 'Barcode detection stopped');\n        return;\n      }\n\n      if (result.barcodes.length === 0) {\n        this.showDetectionResult();\n        return;\n      }\n      // The scan result can contain multiple barcodes,\n      // this example just conveniently displays the first one\n      const barcode = result.barcodes[0];\n      this.showDetectionResult(barcode.type, barcode.text);\n    });\n  }\n\n  showDetectionResult(format = '-', text = '-') {\n    this._ngZone.run(() => {\n      this.barcodeFormat = format;\n      this.barcodeText = text;\n    });\n  }\n}\n"],"sourceRoot":""}